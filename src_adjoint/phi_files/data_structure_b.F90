!        Generated by TAPENADE     (INRIA, Ecuador team)
!  Tapenade 3.14 (r7259) - 18 Jan 2019 09:36
!
MODULE DATA_STRUCTURE_MOD_DIFF
  USE PARAMETER_MOD
  IMPLICIT NONE
! contains
! subroutine allocate_soln()
!         implicit none
!         allocate(point%sensor(max_points))
!         allocate(point%D2_dist(max_points))
!         allocate(point%delta(max_points))
!         allocate(point%xpos_nbhs(max_points))
!         allocate(point%xneg_nbhs(max_points))
!         allocate(point%ypos_nbhs(max_points))
!         allocate(point%yneg_nbhs(max_points))
!         allocate(point%xpos_conn(max_points,15))
!         allocate(point%xneg_conn(max_points,15))
!         allocate(point%ypos_conn(max_points,15))
!         allocate(point%yneg_conn(max_points,15))
!         ! allocate(point%U_old(4,max_points))
!         allocate(point%U(4,max_points))
!         allocate(point%prim(4,max_points))
!         allocate(point%prim_old(4,max_points))
!         allocate(point%flux_res(4,max_points))
!         allocate(point%q(4,max_points))
!         allocate(point%phi1(4,max_points))
!         allocate(point%phi2(4,max_points))
!         allocate(point%dq(2,4,max_points))
!         allocate(point%ddq(3,4,max_points))
!         allocate(point%temp(3,4,max_points))
!         allocate(point%qm(2,4,max_points))
!         allocate(Cl(shapes))
!         allocate(Cd(shapes))
!         allocate(Cm(shapes))
!         allocate(point%entropy(max_points))
! end subroutine
! subroutine deallocate_soln()
!         implicit none
!         deallocate(point%prim)
!         deallocate(point%sensor)
!         deallocate(point%D2_dist)
!         deallocate(point%xpos_nbhs)
!         deallocate(point%xneg_nbhs)
!         deallocate(point%ypos_nbhs)
!         deallocate(point%yneg_nbhs)
!         deallocate(point%xpos_conn)
!         deallocate(point%xneg_conn)
!         deallocate(point%ypos_conn)
!         deallocate(point%yneg_conn)
!         deallocate(Cl)
!         deallocate(Cd)
!         deallocate(Cm)
!         deallocate(point%entropy)
! end subroutine
  INTEGER, PARAMETER :: max_points=9600
  INTEGER, PARAMETER :: wall_points=159, interior_points=9281, &
& outer_points=160, shape_points=160
!       No of shapes
  INTEGER, PARAMETER :: shapes=1
! stores location of point
! stores shape point belongs to
  TYPE POINTS
      REAL*8, DIMENSION(max_points) :: x, y
      INTEGER, DIMENSION(max_points) :: left, right
      INTEGER, DIMENSION(max_points) :: flag_1
      INTEGER, DIMENSION(max_points) :: flag_2
      INTEGER, DIMENSION(max_points) :: nbhs
      REAL*8, DIMENSION(max_points) :: delta
      INTEGER, DIMENSION(max_points, 15) :: conn
      INTEGER, DIMENSION(max_points) :: qtdepth
      REAL*8, DIMENSION(max_points) :: nx, ny
      REAL*8, DIMENSION(max_points) :: min_dist
      REAL*8, DIMENSION(4, max_points) :: prim
      REAL*8, DIMENSION(4, max_points) :: prim_old
      REAL*8, DIMENSION(4, max_points) :: u
      REAL*8, DIMENSION(4, max_points) :: q
      REAL*8, DIMENSION(4, max_points) :: flux_res
      REAL*8, DIMENSION(2, 4, max_points) :: qm
      REAL*8, DIMENSION(2, 4, max_points) :: dq
      REAL*8, DIMENSION(3, 4, max_points) :: ddq
      REAL*8, DIMENSION(3, 4, max_points) :: temp
      REAL*8, DIMENSION(4, max_points) :: phi1, phi2
      REAL*8, DIMENSION(max_points) :: sensor, d2_dist
      INTEGER, DIMENSION(max_points) :: xpos_nbhs, xneg_nbhs, ypos_nbhs&
&     , yneg_nbhs
      INTEGER, DIMENSION(max_points, 15) :: xpos_conn, xneg_conn
      INTEGER, DIMENSION(max_points, 15) :: ypos_conn, yneg_conn
      REAL*8, DIMENSION(max_points) :: entropy
  END TYPE POINTS
  TYPE POINTS_DIFF
      REAL*8, DIMENSION(max_points) :: delta
      REAL*8, DIMENSION(4, max_points) :: prim
      REAL*8, DIMENSION(4, max_points) :: prim_old
      REAL*8, DIMENSION(4, max_points) :: q
      REAL*8, DIMENSION(4, max_points) :: flux_res
      REAL*8, DIMENSION(2, 4, max_points) :: dq
      REAL*8, DIMENSION(3, 4, max_points) :: ddq
      REAL*8, DIMENSION(3, 4, max_points) :: temp
      REAL*8, DIMENSION(4, max_points) :: phi1
      REAL*8, DIMENSION(4, max_points) :: phi2
  END TYPE POINTS_DIFF
  TYPE(POINTS) :: point
  TYPE(POINTS_DIFF) :: pointb
  SAVE
  INTEGER, DIMENSION(wall_points) :: wall_points_index
  INTEGER, DIMENSION(shape_points) :: shape_points_index
  INTEGER, DIMENSION(outer_points) :: outer_points_index
  INTEGER, DIMENSION(interior_points) :: interior_points_index
  REAL*8 :: cost_func
  REAL*8 :: cost_funcb
!iterations
  INTEGER :: it, itr
!Flag for time stepping
  INTEGER, SAVE :: rks=1
!checkpoints
  INTEGER, SAVE :: chkpts=1
  REAL*8, SAVE :: euler=2.0d0
  CHARACTER(len=20), SAVE :: tscheme='first'
  REAL*8, DIMENSION(shapes) :: cl, cd, cm
  REAL*8 :: total_entropy
  REAL*8 :: res_old, res_new, residue
  REAL*8 :: max_res
  INTEGER :: max_res_point
  REAL*8 :: sum_res_sqr
!The parameter CFL is the CFL number for stability ..
  REAL*8, SAVE :: cfl=0.0d0
  INTEGER, SAVE :: max_iters=10000000
!
!       The parameter power is used to specify the weights
!       in the LS formula for the derivatives ..
!       power = 0.0d0, -2.0d0, -4.0d0, -6.0d0 ..
!       For example, power = -2.0 implies that
!       power = -2.0 => weights = 1/d^2
!       power = -4.0 => weights = 1/d^4
!
  REAL*8, SAVE :: power=0.0d0
!
! Venkatakrishnan limiter constant ..
  REAL*8, SAVE :: vl_const=150.0d0
!       Restart solution parameter
  CHARACTER(len=20), SAVE :: restart_solution='no'
  INTEGER :: solution_restart
!       Inner Iterations Loop count
  INTEGER, SAVE :: inner_iterations=0
!       format tag
  CHARACTER(len=20), SAVE :: format_file='legacy'
  INTEGER, SAVE :: file_format=1
!       solution accuracy
  CHARACTER(len=20), SAVE :: solution_accuracy='second'
  REAL*8 :: f_o_flag
!       save frequency
  INTEGER, SAVE :: nsave=10000000
!       Interior normal flag
  INTEGER, SAVE :: interior_points_normal_flag=0
!       Restart
  INTEGER, SAVE :: restart=0
!       Block input
  INTEGER, SAVE :: blockx=32
  INTEGER, SAVE :: blocky=1
  INTEGER, SAVE :: blockz=1
END MODULE DATA_STRUCTURE_MOD_DIFF
