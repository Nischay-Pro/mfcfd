!        Generated by TAPENADE     (INRIA, Ecuador team)
!  Tapenade 3.14 (r7079) -  5 Oct 2018 09:56
!
!        Generated by TAPENADE     (INRIA, Ecuador team)
!  Tapenade 3.14 (r7079) -  5 Oct 2018 09:56
!
MODULE DATA_STRUCTURE_MOD_DIFF_DIFF
  USE PARAMETER_MOD_DIFF
  IMPLICIT NONE
  INTEGER, SAVE :: max_points=9600
  INTEGER, SAVE :: local_points=9600
  INTEGER, SAVE :: wall_points=159
  INTEGER, SAVE :: interior_points=9281
  INTEGER, SAVE :: outer_points=160
  INTEGER, SAVE :: shape_points=160
! stores location of point
! stores shape point belongs to 
! Implicit data
  TYPE POINTS
      INTEGER, DIMENSION(max_points) :: original_id
      REAL*8, DIMENSION(max_points) :: x, y
      INTEGER, DIMENSION(max_points) :: left, right
      INTEGER, DIMENSION(max_points) :: flag_1
      INTEGER, DIMENSION(max_points) :: flag_2
      REAL*8, DIMENSION(max_points) :: nx, ny
      INTEGER, DIMENSION(max_points) :: nbhs
      INTEGER, DIMENSION(max_points, 15) :: conn
      REAL*8, DIMENSION(max_points) :: min_dist
      REAL*8, DIMENSION(4, max_points) :: prim
      REAL*8, DIMENSION(4, max_points) :: prim_old
      REAL*8, DIMENSION(4, max_points) :: flux_res
      REAL*8, DIMENSION(4, max_points) :: q
      REAL*8, DIMENSION(2, 4, max_points) :: dq
      REAL*8, DIMENSION(2, 4, max_points) :: qm
      REAL*8, DIMENSION(max_points) :: entropy, vorticity, vorticity_sqr
      INTEGER, DIMENSION(max_points) :: xpos_nbhs, xneg_nbhs, ypos_nbhs&
&     , yneg_nbhs
      INTEGER, DIMENSION(max_points, 15) :: xpos_conn, xneg_conn
      INTEGER, DIMENSION(max_points, 15) :: ypos_conn, yneg_conn
      REAL*8, DIMENSION(max_points) :: delta
      REAL*8, DIMENSION(4, max_points) :: u_old
  END TYPE POINTS
  TYPE POINTS_DIFF0
      REAL*8, DIMENSION(max_points) :: x
      REAL*8, DIMENSION(max_points) :: y
      REAL*8, DIMENSION(max_points) :: nx
      REAL*8, DIMENSION(max_points) :: ny
      REAL*8, DIMENSION(4, max_points) :: prim
      REAL*8, DIMENSION(4, max_points) :: prim_old
      REAL*8, DIMENSION(4, max_points) :: flux_res
      REAL*8, DIMENSION(4, max_points) :: q
      REAL*8, DIMENSION(2, 4, max_points) :: dq
      REAL*8, DIMENSION(2, 4, max_points) :: qm
      REAL*8, DIMENSION(max_points) :: delta
  END TYPE POINTS_DIFF0
  TYPE POINTS_DIFF
      REAL*8, DIMENSION(4, max_points) :: prim
      REAL*8, DIMENSION(4, max_points) :: prim_old
      REAL*8, DIMENSION(4, max_points) :: flux_res
      REAL*8, DIMENSION(4, max_points) :: q
      REAL*8, DIMENSION(2, 4, max_points) :: dq
      REAL*8, DIMENSION(2, 4, max_points) :: qm
      REAL*8, DIMENSION(max_points) :: delta
  END TYPE POINTS_DIFF
  TYPE(POINTS) :: point
  TYPE(POINTS_DIFF0) :: pointb
  TYPE(POINTS_DIFF) :: pointd
  TYPE(POINTS_DIFF) :: pointdb
  SAVE 
  INTEGER, DIMENSION(wall_points) :: wall_points_index
  INTEGER, DIMENSION(wall_points) :: outer_points_index
  INTEGER, DIMENSION(wall_points) :: interior_points_index
  INTEGER, DIMENSION(wall_points) :: shape_points_index
!iterations
  INTEGER :: it, itr, restart
  REAL*8 :: res_old, res_new, residue, max_res
  REAL*8 :: gsum_res_sqr, sum_res_sqr
  INTEGER :: max_res_point
  REAL*8, DIMENSION(shapes) :: cl, cd, cm, clcd
  REAL*8, DIMENSION(shapes) :: cld, cdd, cmd
  REAL*8, DIMENSION(shapes) :: cldb, cddb, cmdb
  REAL*8 :: total_entropy, total_enstrophy
  INTEGER :: plen
  INTEGER :: format
!The parameter CFL is the CFL number for stability ..
  REAL*8 :: cfl
  INTEGER :: max_iters
!Flag for time stepping
  INTEGER :: rks
  REAL*8 :: euler
!
!       The parameter power is used to specify the weights 
!       in the LS formula for the derivatives ..
!       power = 0.0d0, -2.0d0, -4.0d0, -6.0d0 ..
!       For example, power = -2.0 implies that
!       power = -2.0 => weights = 1/d^2
!       power = -4.0 => weights = 1/d^4
!
  REAL*8 :: power
!
!       limiter_flag = 1 => venkatakrishnan limiter
!       limiter_flag = 2 => min-max limiter     
!
  INTEGER :: limiter_flag
! Venkatakrishnan limiter constant ..
  REAL*8 :: vl_const
  INTEGER :: initial_conditions_flag
!       Interior points normal flag ..
!       If flag is zero => nx = 0.0 and ny = 1.0
!
  INTEGER :: interior_points_normal_flag
!       Restart solution parameter
  INTEGER :: solution_restart
!       solution save parameter
  INTEGER :: nsave
!       First order flag
  REAL*8 :: fo_flag
!       Objective function
  REAL*8 :: cl_flag, cd_flag, cm_flag, cl_cd_flag, ent_flag, ens_flag
  INTEGER :: obj_flag
!       No of shapes
  INTEGER, SAVE :: shapes=1
END MODULE DATA_STRUCTURE_MOD_DIFF_DIFF

